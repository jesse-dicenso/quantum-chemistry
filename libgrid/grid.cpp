#include "grid.hpp"

grid::grid(const Molecule &mol, int num_radial, int num_angular, int becke_k){
	// radial  : Gauss-Chebyshev of the second kind
	// angular : lebedev (degree 230)
	assert( (num_radial >= 0) && (num_angular == 230) );

	num_gridpoints = num_radial * num_angular * mol.Natoms;

	x.resize(num_gridpoints);
	y.resize(num_gridpoints);
	z.resize(num_gridpoints);
	w.resize(num_gridpoints);

	double gauss_chebyshev_x, gauss_chebyshev_w, gauss_chebyshev_factor, r;
	int idx = 0;
	if(mol.Natoms == 1){
		for(int i = 1; i <= num_radial; i++){
			gauss_chebyshev_x = std::cos(M_PI * i / (num_radial + 1));
			r = (bragg_slater_radii[mol.Zvals[0] - 1] / 2) * (1 + gauss_chebyshev_x) / (1 - gauss_chebyshev_x);
			gauss_chebyshev_factor = r / sqrt(1 - gauss_chebyshev_x * gauss_chebyshev_x);
			gauss_chebyshev_factor *= gauss_chebyshev_factor * gauss_chebyshev_factor * 2;
			gauss_chebyshev_w = std::sin(M_PI * i / (num_radial + 1));
			gauss_chebyshev_w *= gauss_chebyshev_w * M_PI / (num_radial + 1) * gauss_chebyshev_factor;
			for(int j = 0; j < num_angular; j++){
				x[idx] = lebedev_x[j] * r + mol.xyz[0][0];
				y[idx] = lebedev_y[j] * r + mol.xyz[0][1];
				z[idx] = lebedev_z[j] * r + mol.xyz[0][2];
				w[idx] = gauss_chebyshev_w * lebedev_w[j];
				idx += 1;
			}
		}
	}
	else{
		for(int atom = 0; atom < mol.Natoms; atom++){
			for(int i = 1; i <= num_radial; i++){
				gauss_chebyshev_x = std::cos(M_PI * i / (num_radial + 1));
				r = (bragg_slater_radii[mol.Zvals[atom] - 1] / 2) * (1 + gauss_chebyshev_x) / (1 - gauss_chebyshev_x);
				gauss_chebyshev_factor = r / sqrt(1 - gauss_chebyshev_x * gauss_chebyshev_x);
				gauss_chebyshev_factor *= gauss_chebyshev_factor * gauss_chebyshev_factor * 2;
				gauss_chebyshev_w = std::sin(M_PI * i / (num_radial + 1));
				gauss_chebyshev_w *= gauss_chebyshev_w * M_PI / (num_radial + 1) * gauss_chebyshev_factor;
				for(int j = 0; j < num_angular; j++){
					x[idx] = lebedev_x[j] * r + mol.xyz[atom][0];
					y[idx] = lebedev_y[j] * r + mol.xyz[atom][1];
					z[idx] = lebedev_z[j] * r + mol.xyz[atom][2];
					w[idx] = gauss_chebyshev_w * lebedev_w[j] * becke_weight(mol, x[idx], y[idx], z[idx], atom, becke_k);
					idx += 1;
				}
			}
		}
	}

	assert(num_gridpoints == idx);
}

// Corresponds to w_me in Becke paper; common k = 3
double becke_weight(const Molecule &mol, double x, double y, double z, int atom_me, int k){
	assert(atom_me < mol.Natoms);
	double r_i, r_j, R_ij, mu_ij, P_i, P_me = 0;
	double sum_P = 0;

	if(mol.heteronuclear){
	double u_ij, a_ij = 0;
		for(int i = 0; i < mol.Natoms; i++){
			P_i = 1;
			r_i = sqrt(	(x-mol.xyz[i][0])*(x-mol.xyz[i][0]) + 
						(y-mol.xyz[i][1])*(y-mol.xyz[i][1]) + 
						(z-mol.xyz[i][2])*(z-mol.xyz[i][2]));
			for(int j = 0; j < mol.Natoms; j++){
				if(j != i){
					r_j  = sqrt((x-mol.xyz[j][0])*(x-mol.xyz[j][0]) + 
								(y-mol.xyz[j][1])*(y-mol.xyz[j][1]) + 
								(z-mol.xyz[j][2])*(z-mol.xyz[j][2]));
					R_ij = sqrt((mol.xyz[i][0]-mol.xyz[j][0])*(mol.xyz[i][0]-mol.xyz[j][0]) + 
								(mol.xyz[i][1]-mol.xyz[j][1])*(mol.xyz[i][1]-mol.xyz[j][1]) + 
								(mol.xyz[i][2]-mol.xyz[j][2])*(mol.xyz[i][2]-mol.xyz[j][2]));
					mu_ij = (r_i - r_j) / R_ij;
					u_ij  = ( (bragg_slater_radii[mol.Zvals[i]-1] / bragg_slater_radii[mol.Zvals[j]-1]) - 1 ) / 
							( (bragg_slater_radii[mol.Zvals[i]-1] / bragg_slater_radii[mol.Zvals[j]-1]) + 1 );
					a_ij  = std::max(-0.5, std::min(0.5, u_ij / (u_ij * u_ij - 1) ));
					mu_ij += a_ij * ( 1 - mu_ij * mu_ij );
					P_i *= 0.5 * (1 - becke_step(mu_ij, k));
				}
			}
			if(i == atom_me) {P_me = P_i;}
			sum_P += P_i;
		}
	}
	else{
		for(int i = 0; i < mol.Natoms; i++){
			P_i = 1;
			r_i = sqrt(	(x-mol.xyz[i][0])*(x-mol.xyz[i][0]) + 
						(y-mol.xyz[i][1])*(y-mol.xyz[i][1]) + 
						(z-mol.xyz[i][2])*(z-mol.xyz[i][2]));
			for(int j = 0; j < mol.Natoms; j++){
				if(j != i){
					r_j  = sqrt((x-mol.xyz[j][0])*(x-mol.xyz[j][0]) + 
								(y-mol.xyz[j][1])*(y-mol.xyz[j][1]) + 
								(z-mol.xyz[j][2])*(z-mol.xyz[j][2]));
					R_ij = sqrt((mol.xyz[i][0]-mol.xyz[j][0])*(mol.xyz[i][0]-mol.xyz[j][0]) + 
								(mol.xyz[i][1]-mol.xyz[j][1])*(mol.xyz[i][1]-mol.xyz[j][1]) + 
								(mol.xyz[i][2]-mol.xyz[j][2])*(mol.xyz[i][2]-mol.xyz[j][2]));
					mu_ij = (r_i - r_j) / R_ij;
					P_i *= 0.5 * (1 - becke_step(mu_ij, k));
				}
			}
			if(i == atom_me) {P_me = P_i;}
			sum_P += P_i;
		}
	}
	return P_me / sum_P;
}

// "Continuous step function" corresponds to f_k in Becke paper
double becke_step(double mu, int k){
	assert(k >= 1);
	mu = std::max(-1.0, std::min(mu, 1.0));
	if(k==1){
		return 1.5 * mu - 0.5 * mu * mu * mu;
	}
	else{
		double temp = becke_step(mu, k-1);
		return 1.5 * temp - 0.5 * temp * temp * temp;
	}
}

const int lebedev_degree = 230;
const double lebedev_x[230] = {
	1.0000000000000000,-1.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.5773502691896257,-0.5773502691896257,0.5773502691896257,0.5773502691896257,
	-0.5773502691896257,0.5773502691896257,-0.5773502691896257,-0.5773502691896257,0.4492044687397611,
	-0.4492044687397611,0.4492044687397611,0.4492044687397611,-0.4492044687397611,-0.4492044687397611,
	0.4492044687397611,-0.4492044687397611,-0.4492044687397611,0.4492044687397611,0.4492044687397611,
	-0.4492044687397611,-0.4492044687397611,0.4492044687397611,-0.4492044687397611,0.4492044687397611,
	0.7722892531483641,-0.7722892531483641,0.7722892531483641,0.7722892531483641,-0.7722892531483641,
	-0.7722892531483641,0.7722892531483641,-0.7722892531483641,0.2520419490210201,-0.2520419490210201,
	0.2520419490210201,0.2520419490210201,-0.2520419490210201,-0.2520419490210201,0.2520419490210201,
	-0.2520419490210201,-0.2520419490210201,0.2520419490210201,0.2520419490210201,-0.2520419490210201,
	-0.2520419490210201,0.2520419490210201,-0.2520419490210201,0.2520419490210201,0.9343177788458117,
	-0.9343177788458117,0.9343177788458117,0.9343177788458117,-0.9343177788458117,-0.9343177788458117,
	0.9343177788458117,-0.9343177788458117,0.6981906658447242,-0.6981906658447242,0.6981906658447242,
	0.6981906658447242,-0.6981906658447242,-0.6981906658447242,0.6981906658447242,-0.6981906658447242,
	-0.6981906658447242,0.6981906658447242,0.6981906658447242,-0.6981906658447242,-0.6981906658447242,
	0.6981906658447242,-0.6981906658447242,0.6981906658447242,0.1583022054634783,-0.1583022054634783,
	0.1583022054634783,0.1583022054634783,-0.1583022054634783,-0.1583022054634783,0.1583022054634783,
	-0.1583022054634783,0.6587405243460960,-0.6587405243460960,0.6587405243460960,0.6587405243460960,
	-0.6587405243460960,-0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,
	0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,0.6587405243460960,
	-0.6587405243460960,0.6587405243460960,0.3634856849567271,-0.3634856849567271,0.3634856849567271,
	0.3634856849567271,-0.3634856849567271,-0.3634856849567271,0.3634856849567271,-0.3634856849567271,
	0.0403854405009766,-0.0403854405009766,0.0403854405009766,0.0403854405009766,-0.0403854405009766,
	-0.0403854405009766,0.0403854405009766,-0.0403854405009766,-0.0403854405009766,0.0403854405009766,
	0.0403854405009766,-0.0403854405009766,-0.0403854405009766,0.0403854405009766,-0.0403854405009766,
	0.0403854405009766,0.9983676839677275,-0.9983676839677275,0.9983676839677275,0.9983676839677275,
	-0.9983676839677275,-0.9983676839677275,0.9983676839677275,-0.9983676839677275,0.5823842309715584,
	-0.5823842309715584,0.5823842309715584,-0.5823842309715584,0.8129136531733653,-0.8129136531733653,
	0.8129136531733653,-0.8129136531733653,0.5823842309715584,-0.5823842309715584,0.5823842309715584,
	-0.5823842309715584,0.8129136531733653,-0.8129136531733653,0.8129136531733653,-0.8129136531733653,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.3545877390518688,-0.3545877390518688,
	0.3545877390518688,-0.3545877390518688,0.9350227458805930,-0.9350227458805930,0.9350227458805930,
	-0.9350227458805930,0.3545877390518688,-0.3545877390518688,0.3545877390518688,-0.3545877390518688,
	0.9350227458805930,-0.9350227458805930,0.9350227458805930,-0.9350227458805930,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.2272181808998187,-0.2272181808998187,0.2272181808998187,
	0.2272181808998187,-0.2272181808998187,0.2272181808998187,-0.2272181808998187,-0.2272181808998187,
	0.4864661535886647,-0.4864661535886647,0.4864661535886647,0.4864661535886647,-0.4864661535886647,
	0.4864661535886647,-0.4864661535886647,-0.4864661535886647,0.8436365210688943,-0.8436365210688943,
	0.8436365210688943,0.8436365210688943,-0.8436365210688943,0.8436365210688943,-0.8436365210688943,
	-0.8436365210688943,0.8436365210688943,-0.8436365210688943,0.8436365210688943,0.8436365210688943,
	-0.8436365210688943,0.8436365210688943,-0.8436365210688943,-0.8436365210688943,0.2272181808998187,
	-0.2272181808998187,0.2272181808998187,0.2272181808998187,-0.2272181808998187,0.2272181808998187,
	-0.2272181808998187,-0.2272181808998187,0.4864661535886647,-0.4864661535886647,0.4864661535886647,
	0.4864661535886647,-0.4864661535886647,0.4864661535886647,-0.4864661535886647,-0.4864661535886647,
};
const double lebedev_y[230] = {
	0.0000000000000000,0.0000000000000000,1.0000000000000000,-1.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.5773502691896257,0.5773502691896257,-0.5773502691896257,0.5773502691896257,
	-0.5773502691896257,-0.5773502691896257,0.5773502691896257,-0.5773502691896257,0.4492044687397611,
	0.4492044687397611,-0.4492044687397611,0.4492044687397611,-0.4492044687397611,0.4492044687397611,
	-0.4492044687397611,-0.4492044687397611,0.7722892531483641,-0.7722892531483641,0.7722892531483641,
	-0.7722892531483641,0.7722892531483641,-0.7722892531483641,-0.7722892531483641,0.7722892531483641,
	0.4492044687397611,0.4492044687397611,-0.4492044687397611,0.4492044687397611,-0.4492044687397611,
	0.4492044687397611,-0.4492044687397611,-0.4492044687397611,0.2520419490210201,0.2520419490210201,
	-0.2520419490210201,0.2520419490210201,-0.2520419490210201,0.2520419490210201,-0.2520419490210201,
	-0.2520419490210201,0.9343177788458117,-0.9343177788458117,0.9343177788458117,-0.9343177788458117,
	0.9343177788458117,-0.9343177788458117,-0.9343177788458117,0.9343177788458117,0.2520419490210201,
	0.2520419490210201,-0.2520419490210201,0.2520419490210201,-0.2520419490210201,0.2520419490210201,
	-0.2520419490210201,-0.2520419490210201,0.6981906658447242,0.6981906658447242,-0.6981906658447242,
	0.6981906658447242,-0.6981906658447242,0.6981906658447242,-0.6981906658447242,-0.6981906658447242,
	0.1583022054634783,-0.1583022054634783,0.1583022054634783,-0.1583022054634783,0.1583022054634783,
	-0.1583022054634783,-0.1583022054634783,0.1583022054634783,0.6981906658447242,0.6981906658447242,
	-0.6981906658447242,0.6981906658447242,-0.6981906658447242,0.6981906658447242,-0.6981906658447242,
	-0.6981906658447242,0.6587405243460960,0.6587405243460960,-0.6587405243460960,0.6587405243460960,
	-0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,0.3634856849567271,
	-0.3634856849567271,0.3634856849567271,-0.3634856849567271,0.3634856849567271,-0.3634856849567271,
	-0.3634856849567271,0.3634856849567271,0.6587405243460960,0.6587405243460960,-0.6587405243460960,
	0.6587405243460960,-0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,
	0.0403854405009766,0.0403854405009766,-0.0403854405009766,0.0403854405009766,-0.0403854405009766,
	0.0403854405009766,-0.0403854405009766,-0.0403854405009766,0.9983676839677275,-0.9983676839677275,
	0.9983676839677275,-0.9983676839677275,0.9983676839677275,-0.9983676839677275,-0.9983676839677275,
	0.9983676839677275,0.0403854405009766,0.0403854405009766,-0.0403854405009766,0.0403854405009766,
	-0.0403854405009766,0.0403854405009766,-0.0403854405009766,-0.0403854405009766,0.8129136531733653,
	0.8129136531733653,-0.8129136531733653,-0.8129136531733653,0.5823842309715584,0.5823842309715584,
	-0.5823842309715584,-0.5823842309715584,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.5823842309715584,-0.5823842309715584,0.5823842309715584,-0.5823842309715584,0.8129136531733653,
	-0.8129136531733653,0.8129136531733653,-0.8129136531733653,0.9350227458805930,0.9350227458805930,
	-0.9350227458805930,-0.9350227458805930,0.3545877390518688,0.3545877390518688,-0.3545877390518688,
	-0.3545877390518688,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.3545877390518688,
	-0.3545877390518688,0.3545877390518688,-0.3545877390518688,0.9350227458805930,-0.9350227458805930,
	0.9350227458805930,-0.9350227458805930,0.4864661535886647,0.4864661535886647,-0.4864661535886647,
	0.4864661535886647,-0.4864661535886647,-0.4864661535886647,0.4864661535886647,-0.4864661535886647,
	0.2272181808998187,0.2272181808998187,-0.2272181808998187,0.2272181808998187,-0.2272181808998187,
	-0.2272181808998187,0.2272181808998187,-0.2272181808998187,0.2272181808998187,0.2272181808998187,
	-0.2272181808998187,0.2272181808998187,-0.2272181808998187,-0.2272181808998187,0.2272181808998187,
	-0.2272181808998187,0.4864661535886647,0.4864661535886647,-0.4864661535886647,0.4864661535886647,
	-0.4864661535886647,-0.4864661535886647,0.4864661535886647,-0.4864661535886647,0.8436365210688943,
	0.8436365210688943,-0.8436365210688943,0.8436365210688943,-0.8436365210688943,-0.8436365210688943,
	0.8436365210688943,-0.8436365210688943,0.8436365210688943,0.8436365210688943,-0.8436365210688943,
	0.8436365210688943,-0.8436365210688943,-0.8436365210688943,0.8436365210688943,-0.8436365210688943
};
const double lebedev_z[230] = {
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,1.0000000000000000,
	-1.0000000000000000,0.5773502691896257,0.5773502691896257,0.5773502691896257,-0.5773502691896257,
	0.5773502691896257,-0.5773502691896257,-0.5773502691896257,-0.5773502691896257,0.7722892531483641,
	0.7722892531483641,0.7722892531483641,-0.7722892531483641,0.7722892531483641,-0.7722892531483641,
	-0.7722892531483641,-0.7722892531483641,0.4492044687397611,0.4492044687397611,-0.4492044687397611,
	0.4492044687397611,-0.4492044687397611,-0.4492044687397611,-0.4492044687397611,0.4492044687397611,
	0.4492044687397611,0.4492044687397611,0.4492044687397611,-0.4492044687397611,0.4492044687397611,
	-0.4492044687397611,-0.4492044687397611,-0.4492044687397611,0.9343177788458117,0.9343177788458117,
	0.9343177788458117,-0.9343177788458117,0.9343177788458117,-0.9343177788458117,-0.9343177788458117,
	-0.9343177788458117,0.2520419490210201,0.2520419490210201,-0.2520419490210201,0.2520419490210201,
	-0.2520419490210201,-0.2520419490210201,-0.2520419490210201,0.2520419490210201,0.2520419490210201,
	0.2520419490210201,0.2520419490210201,-0.2520419490210201,0.2520419490210201,-0.2520419490210201,
	-0.2520419490210201,-0.2520419490210201,0.1583022054634783,0.1583022054634783,0.1583022054634783,
	-0.1583022054634783,0.1583022054634783,-0.1583022054634783,-0.1583022054634783,-0.1583022054634783,
	0.6981906658447242,0.6981906658447242,-0.6981906658447242,0.6981906658447242,-0.6981906658447242,
	-0.6981906658447242,-0.6981906658447242,0.6981906658447242,0.6981906658447242,0.6981906658447242,
	0.6981906658447242,-0.6981906658447242,0.6981906658447242,-0.6981906658447242,-0.6981906658447242,
	-0.6981906658447242,0.3634856849567271,0.3634856849567271,0.3634856849567271,-0.3634856849567271,
	0.3634856849567271,-0.3634856849567271,-0.3634856849567271,-0.3634856849567271,0.6587405243460960,
	0.6587405243460960,-0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,
	-0.6587405243460960,0.6587405243460960,0.6587405243460960,0.6587405243460960,0.6587405243460960,
	-0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,-0.6587405243460960,
	0.9983676839677275,0.9983676839677275,0.9983676839677275,-0.9983676839677275,0.9983676839677275,
	-0.9983676839677275,-0.9983676839677275,-0.9983676839677275,0.0403854405009766,0.0403854405009766,
	-0.0403854405009766,0.0403854405009766,-0.0403854405009766,-0.0403854405009766,-0.0403854405009766,
	0.0403854405009766,0.0403854405009766,0.0403854405009766,0.0403854405009766,-0.0403854405009766,
	0.0403854405009766,-0.0403854405009766,-0.0403854405009766,-0.0403854405009766,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.8129136531733653,0.8129136531733653,-0.8129136531733653,
	-0.8129136531733653,0.5823842309715584,0.5823842309715584,-0.5823842309715584,-0.5823842309715584,
	0.8129136531733653,0.8129136531733653,-0.8129136531733653,-0.8129136531733653,0.5823842309715584,
	0.5823842309715584,-0.5823842309715584,-0.5823842309715584,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.9350227458805930,0.9350227458805930,-0.9350227458805930,-0.9350227458805930,
	0.3545877390518688,0.3545877390518688,-0.3545877390518688,-0.3545877390518688,0.9350227458805930,
	0.9350227458805930,-0.9350227458805930,-0.9350227458805930,0.3545877390518688,0.3545877390518688,
	-0.3545877390518688,-0.3545877390518688,0.8436365210688943,0.8436365210688943,0.8436365210688943,
	-0.8436365210688943,0.8436365210688943,-0.8436365210688943,-0.8436365210688943,-0.8436365210688943,
	0.8436365210688943,0.8436365210688943,0.8436365210688943,-0.8436365210688943,0.8436365210688943,
	-0.8436365210688943,-0.8436365210688943,-0.8436365210688943,0.4864661535886647,0.4864661535886647,
	0.4864661535886647,-0.4864661535886647,0.4864661535886647,-0.4864661535886647,-0.4864661535886647,
	-0.4864661535886647,0.2272181808998187,0.2272181808998187,0.2272181808998187,-0.2272181808998187,
	0.2272181808998187,-0.2272181808998187,-0.2272181808998187,-0.2272181808998187,0.4864661535886647,
	0.4864661535886647,0.4864661535886647,-0.4864661535886647,0.4864661535886647,-0.4864661535886647,
	-0.4864661535886647,-0.4864661535886647,0.2272181808998187,0.2272181808998187,0.2272181808998187,
	-0.2272181808998187,0.2272181808998187,-0.2272181808998187,-0.2272181808998187,-0.2272181808998187
};
const double lebedev_w[230] = {
	-0.6939954000094836,-0.6939954000094836,-0.6939954000094836,-0.6939954000094836,-0.6939954000094836,
	-0.6939954000094836,0.0559238000528285,0.0559238000528285,0.0559238000528285,0.0559238000528285,
	0.0559238000528285,0.0559238000528285,0.0559238000528285,0.0559238000528285,0.0565089714533711,
	0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,
	0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,
	0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,
	0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,
	0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0634495335474864,0.0634495335474864,
	0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,
	0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,
	0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,
	0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,
	0.0634495335474864,0.0634495335474864,0.0499690168687494,0.0499690168687494,0.0499690168687494,
	0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,
	0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,
	0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,
	0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,
	0.0499690168687494,0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,
	0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,
	0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,
	0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,
	0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,
	0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,
	0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,
	0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,
	0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,
	0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,0.0531693582764104,
	0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,
	0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,
	0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,
	0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,
	0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0653208723911648,0.0653208723911648,
	0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,
	0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,
	0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,
	0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,
	0.0653208723911648,0.0653208723911648,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197
};

const double bragg_slater_radii[118] = {
	1.3228082881354475,	// H (*2)
	2.645616576270895,	// He
	2.7401028825662843,	// Li
	1.9842124322031713,	// Be
	1.6062672070216149,	// B
	1.3228082881354475,	// C
	1.2283219818400586,	// N
	1.1338356755446692,	// O
	0.9448630629538911,	// F
	2.834589188861673,	// Ne
	3.401507026634008,	// Na
	2.834589188861673,	// Mg
	2.362157657384728,	// Al
	2.0786987384985607,	// Si
	1.8897261259077822,	// P
	1.8897261259077822,	// S
	1.8897261259077822,	// Cl
	3.401507026634008,	// Ar
	4.157397476997121,	// K
	3.401507026634008,	// Ca
	3.023561801452452,	// Sc
	2.645616576270895,	// Ti
	2.551130269975506,	// V
	2.645616576270895,	// Cr
	2.645616576270895,	// Mn
	2.645616576270895,	// Fe
	2.551130269975506,	// Co
	2.551130269975506,	// Ni
	2.551130269975506,	// Cu
	2.551130269975506,	// Zn
	2.456643963680117,	// Ga
	2.362157657384728,	// Ge
	2.1731850447939496,	// As
	2.1731850447939496,	// Se
	2.1731850447939496,	// Br
	3.590479639224786,	// Kr
	4.440856395883288,	// Rb
	3.7794522518155644,	// Sr
	3.401507026634008,	// Y
	2.9290754951570626,	// Zr
	2.7401028825662843,	// Nb
	2.7401028825662843,	// Mo
	2.551130269975506,	// Tc
	2.456643963680117,	// Ru
	2.551130269975506,	// Rh
	2.645616576270895,	// Pd
	3.023561801452452,	// Ag
	2.9290754951570626,	// Cd
	2.9290754951570626,	// In
	2.7401028825662843,	// Sn
	2.7401028825662843,	// Sb
	2.645616576270895,	// Te
	2.645616576270895,	// I
	3.9684248644063427,	// Xe
	4.913287927360234,	// Cs
	4.062911170701732,	// Ba
	3.684965945520175,	// La
	3.4959933329293973,	// Ce
	3.4959933329293973,	// Pr
	3.4959933329293973,	// Nd
	3.4959933329293973,	// Pm
	3.4959933329293973,	// Sm
	3.4959933329293973,	// Eu
	3.401507026634008,	// Gd
	3.307020720338619,	// Tb
	3.307020720338619,	// Dy
	3.307020720338619,	// Ho
	3.307020720338619,	// Er
	3.307020720338619,	// Tm
	3.307020720338619,	// Yb
	3.307020720338619,	// Lu
	2.9290754951570626,	// Hf
	2.7401028825662843,	// Ta
	2.551130269975506,	// W
	2.551130269975506,	// Re
	2.456643963680117,	// Os
	2.551130269975506,	// Ir
	2.551130269975506,	// Pt
	2.551130269975506,	// Au
	2.834589188861673,	// Hg
	3.590479639224786,	// Tl
	3.401507026634008,	// Pb
	3.023561801452452,	// Bi
	3.590479639224786,	// Po
	2.7401028825662843,	// At
	3.9684248644063427,	// Rn
	3.401507026634008,	// Fr
	4.062911170701732,	// Ra
	3.684965945520175,	// Ac
	3.401507026634008,	// Th
	3.401507026634008,	// Pa
	3.307020720338619,	// U
	3.307020720338619,	// Np
	3.307020720338619,	// Pu
	3.307020720338619,	// Am
	3.307020720338619,	// Cm
	3.307020720338619,	// Bk
	3.307020720338619,	// Cf
	3.307020720338619,	// Es
	3.307020720338619,	// Fm
	3.307020720338619,	// Md
	3.307020720338619,	// No
	3.307020720338619,	// Lr
	3.307020720338619,	// Rf
	3.307020720338619,	// Db
	3.307020720338619,	// Sg
	3.307020720338619,	// Bh
	3.307020720338619,	// Hs
	3.307020720338619,	// Mt
	3.307020720338619,	// Ds
	3.307020720338619,	// Rg
	3.307020720338619,	// Cn
	3.307020720338619,	// Nh
	3.307020720338619,	// Fl
	3.307020720338619,	// Mc
	3.307020720338619,	// Lv
	3.307020720338619,	// Ts
	3.307020720338619	// Og
};
