#include "quadrature.hpp"

// Lebedev quadrature of order 25, Gauss-Chebyshev quadrature of the second kind
double lebedev_gauss_chebyshev(double (*func)(double, double, double, void*), void* ctx, double c_x, double c_y, double c_z, double bragg_slater_r, int gauss_chebyshev_n){
	double sum = 0;
	double gauss_chebyshev_x, gauss_chebyshev_w, gauss_chebyshev_factor, r;
	for(int i = 1; i <= gauss_chebyshev_n; i++){
		gauss_chebyshev_x = std::cos(M_PI * i / (gauss_chebyshev_n + 1));
		gauss_chebyshev_w = pow(std::sin(M_PI * i / (gauss_chebyshev_n + 1)), 2) * M_PI / (gauss_chebyshev_n + 1);
		r = (bragg_slater_r / 2) * (1 + gauss_chebyshev_x) / (1 - gauss_chebyshev_x);
		gauss_chebyshev_factor = 2 * pow(r / sqrt(1 - gauss_chebyshev_x * gauss_chebyshev_x), 3);
		for(int j = 0; j < lebedev_degree; j++){
			sum += gauss_chebyshev_w * lebedev_w[j] * gauss_chebyshev_factor * func(lebedev_x[j]*r+c_x,lebedev_y[j]*r+c_y,lebedev_z[j]*r+c_z, ctx);
		}
	}
	return sum;
}

const int lebedev_degree = 230;
const double lebedev_x[230] = {
	1.0000000000000000,-1.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.5773502691896257,-0.5773502691896257,0.5773502691896257,0.5773502691896257,
	-0.5773502691896257,0.5773502691896257,-0.5773502691896257,-0.5773502691896257,0.4492044687397611,
	-0.4492044687397611,0.4492044687397611,0.4492044687397611,-0.4492044687397611,-0.4492044687397611,
	0.4492044687397611,-0.4492044687397611,-0.4492044687397611,0.4492044687397611,0.4492044687397611,
	-0.4492044687397611,-0.4492044687397611,0.4492044687397611,-0.4492044687397611,0.4492044687397611,
	0.7722892531483641,-0.7722892531483641,0.7722892531483641,0.7722892531483641,-0.7722892531483641,
	-0.7722892531483641,0.7722892531483641,-0.7722892531483641,0.2520419490210201,-0.2520419490210201,
	0.2520419490210201,0.2520419490210201,-0.2520419490210201,-0.2520419490210201,0.2520419490210201,
	-0.2520419490210201,-0.2520419490210201,0.2520419490210201,0.2520419490210201,-0.2520419490210201,
	-0.2520419490210201,0.2520419490210201,-0.2520419490210201,0.2520419490210201,0.9343177788458117,
	-0.9343177788458117,0.9343177788458117,0.9343177788458117,-0.9343177788458117,-0.9343177788458117,
	0.9343177788458117,-0.9343177788458117,0.6981906658447242,-0.6981906658447242,0.6981906658447242,
	0.6981906658447242,-0.6981906658447242,-0.6981906658447242,0.6981906658447242,-0.6981906658447242,
	-0.6981906658447242,0.6981906658447242,0.6981906658447242,-0.6981906658447242,-0.6981906658447242,
	0.6981906658447242,-0.6981906658447242,0.6981906658447242,0.1583022054634783,-0.1583022054634783,
	0.1583022054634783,0.1583022054634783,-0.1583022054634783,-0.1583022054634783,0.1583022054634783,
	-0.1583022054634783,0.6587405243460960,-0.6587405243460960,0.6587405243460960,0.6587405243460960,
	-0.6587405243460960,-0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,
	0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,0.6587405243460960,
	-0.6587405243460960,0.6587405243460960,0.3634856849567271,-0.3634856849567271,0.3634856849567271,
	0.3634856849567271,-0.3634856849567271,-0.3634856849567271,0.3634856849567271,-0.3634856849567271,
	0.0403854405009766,-0.0403854405009766,0.0403854405009766,0.0403854405009766,-0.0403854405009766,
	-0.0403854405009766,0.0403854405009766,-0.0403854405009766,-0.0403854405009766,0.0403854405009766,
	0.0403854405009766,-0.0403854405009766,-0.0403854405009766,0.0403854405009766,-0.0403854405009766,
	0.0403854405009766,0.9983676839677275,-0.9983676839677275,0.9983676839677275,0.9983676839677275,
	-0.9983676839677275,-0.9983676839677275,0.9983676839677275,-0.9983676839677275,0.5823842309715584,
	-0.5823842309715584,0.5823842309715584,-0.5823842309715584,0.8129136531733653,-0.8129136531733653,
	0.8129136531733653,-0.8129136531733653,0.5823842309715584,-0.5823842309715584,0.5823842309715584,
	-0.5823842309715584,0.8129136531733653,-0.8129136531733653,0.8129136531733653,-0.8129136531733653,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.3545877390518688,-0.3545877390518688,
	0.3545877390518688,-0.3545877390518688,0.9350227458805930,-0.9350227458805930,0.9350227458805930,
	-0.9350227458805930,0.3545877390518688,-0.3545877390518688,0.3545877390518688,-0.3545877390518688,
	0.9350227458805930,-0.9350227458805930,0.9350227458805930,-0.9350227458805930,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.2272181808998187,-0.2272181808998187,0.2272181808998187,
	0.2272181808998187,-0.2272181808998187,0.2272181808998187,-0.2272181808998187,-0.2272181808998187,
	0.4864661535886647,-0.4864661535886647,0.4864661535886647,0.4864661535886647,-0.4864661535886647,
	0.4864661535886647,-0.4864661535886647,-0.4864661535886647,0.8436365210688943,-0.8436365210688943,
	0.8436365210688943,0.8436365210688943,-0.8436365210688943,0.8436365210688943,-0.8436365210688943,
	-0.8436365210688943,0.8436365210688943,-0.8436365210688943,0.8436365210688943,0.8436365210688943,
	-0.8436365210688943,0.8436365210688943,-0.8436365210688943,-0.8436365210688943,0.2272181808998187,
	-0.2272181808998187,0.2272181808998187,0.2272181808998187,-0.2272181808998187,0.2272181808998187,
	-0.2272181808998187,-0.2272181808998187,0.4864661535886647,-0.4864661535886647,0.4864661535886647,
	0.4864661535886647,-0.4864661535886647,0.4864661535886647,-0.4864661535886647,-0.4864661535886647,
};
const double lebedev_y[230] = {
	0.0000000000000000,0.0000000000000000,1.0000000000000000,-1.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.5773502691896257,0.5773502691896257,-0.5773502691896257,0.5773502691896257,
	-0.5773502691896257,-0.5773502691896257,0.5773502691896257,-0.5773502691896257,0.4492044687397611,
	0.4492044687397611,-0.4492044687397611,0.4492044687397611,-0.4492044687397611,0.4492044687397611,
	-0.4492044687397611,-0.4492044687397611,0.7722892531483641,-0.7722892531483641,0.7722892531483641,
	-0.7722892531483641,0.7722892531483641,-0.7722892531483641,-0.7722892531483641,0.7722892531483641,
	0.4492044687397611,0.4492044687397611,-0.4492044687397611,0.4492044687397611,-0.4492044687397611,
	0.4492044687397611,-0.4492044687397611,-0.4492044687397611,0.2520419490210201,0.2520419490210201,
	-0.2520419490210201,0.2520419490210201,-0.2520419490210201,0.2520419490210201,-0.2520419490210201,
	-0.2520419490210201,0.9343177788458117,-0.9343177788458117,0.9343177788458117,-0.9343177788458117,
	0.9343177788458117,-0.9343177788458117,-0.9343177788458117,0.9343177788458117,0.2520419490210201,
	0.2520419490210201,-0.2520419490210201,0.2520419490210201,-0.2520419490210201,0.2520419490210201,
	-0.2520419490210201,-0.2520419490210201,0.6981906658447242,0.6981906658447242,-0.6981906658447242,
	0.6981906658447242,-0.6981906658447242,0.6981906658447242,-0.6981906658447242,-0.6981906658447242,
	0.1583022054634783,-0.1583022054634783,0.1583022054634783,-0.1583022054634783,0.1583022054634783,
	-0.1583022054634783,-0.1583022054634783,0.1583022054634783,0.6981906658447242,0.6981906658447242,
	-0.6981906658447242,0.6981906658447242,-0.6981906658447242,0.6981906658447242,-0.6981906658447242,
	-0.6981906658447242,0.6587405243460960,0.6587405243460960,-0.6587405243460960,0.6587405243460960,
	-0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,0.3634856849567271,
	-0.3634856849567271,0.3634856849567271,-0.3634856849567271,0.3634856849567271,-0.3634856849567271,
	-0.3634856849567271,0.3634856849567271,0.6587405243460960,0.6587405243460960,-0.6587405243460960,
	0.6587405243460960,-0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,
	0.0403854405009766,0.0403854405009766,-0.0403854405009766,0.0403854405009766,-0.0403854405009766,
	0.0403854405009766,-0.0403854405009766,-0.0403854405009766,0.9983676839677275,-0.9983676839677275,
	0.9983676839677275,-0.9983676839677275,0.9983676839677275,-0.9983676839677275,-0.9983676839677275,
	0.9983676839677275,0.0403854405009766,0.0403854405009766,-0.0403854405009766,0.0403854405009766,
	-0.0403854405009766,0.0403854405009766,-0.0403854405009766,-0.0403854405009766,0.8129136531733653,
	0.8129136531733653,-0.8129136531733653,-0.8129136531733653,0.5823842309715584,0.5823842309715584,
	-0.5823842309715584,-0.5823842309715584,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.5823842309715584,-0.5823842309715584,0.5823842309715584,-0.5823842309715584,0.8129136531733653,
	-0.8129136531733653,0.8129136531733653,-0.8129136531733653,0.9350227458805930,0.9350227458805930,
	-0.9350227458805930,-0.9350227458805930,0.3545877390518688,0.3545877390518688,-0.3545877390518688,
	-0.3545877390518688,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.3545877390518688,
	-0.3545877390518688,0.3545877390518688,-0.3545877390518688,0.9350227458805930,-0.9350227458805930,
	0.9350227458805930,-0.9350227458805930,0.4864661535886647,0.4864661535886647,-0.4864661535886647,
	0.4864661535886647,-0.4864661535886647,-0.4864661535886647,0.4864661535886647,-0.4864661535886647,
	0.2272181808998187,0.2272181808998187,-0.2272181808998187,0.2272181808998187,-0.2272181808998187,
	-0.2272181808998187,0.2272181808998187,-0.2272181808998187,0.2272181808998187,0.2272181808998187,
	-0.2272181808998187,0.2272181808998187,-0.2272181808998187,-0.2272181808998187,0.2272181808998187,
	-0.2272181808998187,0.4864661535886647,0.4864661535886647,-0.4864661535886647,0.4864661535886647,
	-0.4864661535886647,-0.4864661535886647,0.4864661535886647,-0.4864661535886647,0.8436365210688943,
	0.8436365210688943,-0.8436365210688943,0.8436365210688943,-0.8436365210688943,-0.8436365210688943,
	0.8436365210688943,-0.8436365210688943,0.8436365210688943,0.8436365210688943,-0.8436365210688943,
	0.8436365210688943,-0.8436365210688943,-0.8436365210688943,0.8436365210688943,-0.8436365210688943
};
const double lebedev_z[230] = {
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,1.0000000000000000,
	-1.0000000000000000,0.5773502691896257,0.5773502691896257,0.5773502691896257,-0.5773502691896257,
	0.5773502691896257,-0.5773502691896257,-0.5773502691896257,-0.5773502691896257,0.7722892531483641,
	0.7722892531483641,0.7722892531483641,-0.7722892531483641,0.7722892531483641,-0.7722892531483641,
	-0.7722892531483641,-0.7722892531483641,0.4492044687397611,0.4492044687397611,-0.4492044687397611,
	0.4492044687397611,-0.4492044687397611,-0.4492044687397611,-0.4492044687397611,0.4492044687397611,
	0.4492044687397611,0.4492044687397611,0.4492044687397611,-0.4492044687397611,0.4492044687397611,
	-0.4492044687397611,-0.4492044687397611,-0.4492044687397611,0.9343177788458117,0.9343177788458117,
	0.9343177788458117,-0.9343177788458117,0.9343177788458117,-0.9343177788458117,-0.9343177788458117,
	-0.9343177788458117,0.2520419490210201,0.2520419490210201,-0.2520419490210201,0.2520419490210201,
	-0.2520419490210201,-0.2520419490210201,-0.2520419490210201,0.2520419490210201,0.2520419490210201,
	0.2520419490210201,0.2520419490210201,-0.2520419490210201,0.2520419490210201,-0.2520419490210201,
	-0.2520419490210201,-0.2520419490210201,0.1583022054634783,0.1583022054634783,0.1583022054634783,
	-0.1583022054634783,0.1583022054634783,-0.1583022054634783,-0.1583022054634783,-0.1583022054634783,
	0.6981906658447242,0.6981906658447242,-0.6981906658447242,0.6981906658447242,-0.6981906658447242,
	-0.6981906658447242,-0.6981906658447242,0.6981906658447242,0.6981906658447242,0.6981906658447242,
	0.6981906658447242,-0.6981906658447242,0.6981906658447242,-0.6981906658447242,-0.6981906658447242,
	-0.6981906658447242,0.3634856849567271,0.3634856849567271,0.3634856849567271,-0.3634856849567271,
	0.3634856849567271,-0.3634856849567271,-0.3634856849567271,-0.3634856849567271,0.6587405243460960,
	0.6587405243460960,-0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,
	-0.6587405243460960,0.6587405243460960,0.6587405243460960,0.6587405243460960,0.6587405243460960,
	-0.6587405243460960,0.6587405243460960,-0.6587405243460960,-0.6587405243460960,-0.6587405243460960,
	0.9983676839677275,0.9983676839677275,0.9983676839677275,-0.9983676839677275,0.9983676839677275,
	-0.9983676839677275,-0.9983676839677275,-0.9983676839677275,0.0403854405009766,0.0403854405009766,
	-0.0403854405009766,0.0403854405009766,-0.0403854405009766,-0.0403854405009766,-0.0403854405009766,
	0.0403854405009766,0.0403854405009766,0.0403854405009766,0.0403854405009766,-0.0403854405009766,
	0.0403854405009766,-0.0403854405009766,-0.0403854405009766,-0.0403854405009766,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.8129136531733653,0.8129136531733653,-0.8129136531733653,
	-0.8129136531733653,0.5823842309715584,0.5823842309715584,-0.5823842309715584,-0.5823842309715584,
	0.8129136531733653,0.8129136531733653,-0.8129136531733653,-0.8129136531733653,0.5823842309715584,
	0.5823842309715584,-0.5823842309715584,-0.5823842309715584,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,
	0.0000000000000000,0.9350227458805930,0.9350227458805930,-0.9350227458805930,-0.9350227458805930,
	0.3545877390518688,0.3545877390518688,-0.3545877390518688,-0.3545877390518688,0.9350227458805930,
	0.9350227458805930,-0.9350227458805930,-0.9350227458805930,0.3545877390518688,0.3545877390518688,
	-0.3545877390518688,-0.3545877390518688,0.8436365210688943,0.8436365210688943,0.8436365210688943,
	-0.8436365210688943,0.8436365210688943,-0.8436365210688943,-0.8436365210688943,-0.8436365210688943,
	0.8436365210688943,0.8436365210688943,0.8436365210688943,-0.8436365210688943,0.8436365210688943,
	-0.8436365210688943,-0.8436365210688943,-0.8436365210688943,0.4864661535886647,0.4864661535886647,
	0.4864661535886647,-0.4864661535886647,0.4864661535886647,-0.4864661535886647,-0.4864661535886647,
	-0.4864661535886647,0.2272181808998187,0.2272181808998187,0.2272181808998187,-0.2272181808998187,
	0.2272181808998187,-0.2272181808998187,-0.2272181808998187,-0.2272181808998187,0.4864661535886647,
	0.4864661535886647,0.4864661535886647,-0.4864661535886647,0.4864661535886647,-0.4864661535886647,
	-0.4864661535886647,-0.4864661535886647,0.2272181808998187,0.2272181808998187,0.2272181808998187,
	-0.2272181808998187,0.2272181808998187,-0.2272181808998187,-0.2272181808998187,-0.2272181808998187
};
const double lebedev_w[230] = {
	-0.6939954000094836,-0.6939954000094836,-0.6939954000094836,-0.6939954000094836,-0.6939954000094836,
	-0.6939954000094836,0.0559238000528285,0.0559238000528285,0.0559238000528285,0.0559238000528285,
	0.0559238000528285,0.0559238000528285,0.0559238000528285,0.0559238000528285,0.0565089714533711,
	0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,
	0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,
	0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,
	0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0565089714533711,
	0.0565089714533711,0.0565089714533711,0.0565089714533711,0.0634495335474864,0.0634495335474864,
	0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,
	0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,
	0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,
	0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,0.0634495335474864,
	0.0634495335474864,0.0634495335474864,0.0499690168687494,0.0499690168687494,0.0499690168687494,
	0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,
	0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,
	0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,
	0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,0.0499690168687494,
	0.0499690168687494,0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,
	0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,
	0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,
	0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,
	0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,0.0553096317949693,
	0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,
	0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,
	0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,
	0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,
	0.2167126344984028,0.2167126344984028,0.2167126344984028,0.2167126344984028,0.0531693582764104,
	0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,
	0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,
	0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,
	0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0531693582764104,
	0.0531693582764104,0.0531693582764104,0.0531693582764104,0.0653208723911648,0.0653208723911648,
	0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,
	0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,
	0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,
	0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,0.0653208723911648,
	0.0653208723911648,0.0653208723911648,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,
	0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197,0.0590081700429197
};
